{% extends 'base.html' %}
{% block content %}
<h1>Crear Reservas para el Vuelo: {{ vuelo.numero }}</h1>
<p>Complete los datos de los pasajeros para los {{ num_pasajeros }} asientos seleccionados.</p>

<form method="post">
    {% csrf_token %}
    {{ formset.management_form }}
    {% for form in formset %}
        <div class="pasajero-form">
            {{ form.as_p }}
        </div>
    {% endfor %}
    <button type="submit">Guardar</button>
</form>

<script>
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('select[name$="-pasajero_existente"]').forEach(function(select) {
        select.addEventListener('change', function() {
            let formGroup = select.closest('.pasajero-form');
            if (!formGroup) return;

            let camposExtra = formGroup.querySelectorAll('input, select, textarea');
            camposExtra.forEach(function(campo) {
                if (campo.name.endsWith('pasajero_existente')) return;
                if (select.value) {
                    campo.closest('p, .form-group, div').style.display = 'none';
                    campo.value = '';
                } else {
                    campo.closest('p, .form-group, div').style.display = '';
                }
            });
        });
    });
});
</script>
{% endblock %}
